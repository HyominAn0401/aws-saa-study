### 📝 675. 데이터 마스킹 및 확장성 확보 솔루션
S3에 고객 PII가 포함된 텍스트 파일이 저장되나 외부 서비스 저공업체에 가장 최근 대화까지 샘플 대화가 무작위로 제공되어야 하며 PII가 공개되어서는 안 됨. 대화 수가 증가하면 솔루션도 확장되어야 하며 최소한의 운영 오버헤드로 구성되어야 함

---

### 🎯 1. 요구사항 분석 
* **텍스트 파일**: 한 번 기록되면 수정되지 않는 불변성 데이터
    - 데이터의 원본을 훼손하지 않으면서 외부 제공자 용으로 가상의 뷰 만들어야 함
* **가장 최근 대화까지**: 방금 생성된 파일이 실시간으로 포함되어야 함
    - 이벤트 기반 또는 요청 기반 처리 필수
    - 배치 방식(일괄처리)는 불가능 
* **고객 대화 수 증가 시 솔루션 확장**: 데이터 유입량이 예측 불가능
    - 인프라 미리 할당(Provisioned) vs Elastic
* **최소한의 운영 오버로드**: 데이터를 다른 곳으로 옮기면 데이터 동기화 및 스토리지 관리 업무 발생
    - 추가적인 저장소를 생성하지 않고 데이터 흐름 중간에서 처리할 것 

---

### 🔍 2. 핵심 서비스 분석 

| 서비스/용어명 | 핵심 특징 | 비고 |
| :--- | :--- | :--- |
| **S3 Object Lambda** | 1. On-the-fly Transformation: S3에서 데이터를 가져오는 GET요청 발생 시 중간에서 Lambda가 개입해 데이터를 변환한 뒤 전달 <br> 2. Access Point 통합: 표준 S3 액세스 포인트 위에 생성, 외부 공급자는 버킷 주소가 아닌 Object Lambda Access Point ARN을 통해 접근 <br> 3. WriteGetObjectResponse: Lambda 내부에서 수정된 데이터를 S3에 다시 저장하는 것이 아니라 클라이언트에게 즉시 응답으로 보내는 전용 API 사용 | 서버리스로 운영 오버헤드 최소화 및 자동 확장 | 
| **DynamoDB** | 1. Key-Value 스토리지 <br> 2. 데이터 만료나 특정 조건 검색에 유리 | |
| **S3 GET 요청** | 1. 클라이언트가 S3 버킷에 직접 또는 일반 액세스 포인트를 통해 객체를 요청하는 방식<br> 2. 데이터에 변형을 가하지 않고 저장된 상태 그대로 반환 | 일반 GET 요청으로는 마스킹 불가능 |
---

### ✅ 3. 선택지 분석 및 풀이

- [X] **A**: S3 Object Lambda 액세스 포인트 + Lambda 함수
    - **결과**: **정답**
    - **이유**: 외부업체가 S3에 데이터 요청(on-the-fly) 시 Lambda가 실행되어 PII 즉시 수정해 보여줌. 원본 그대로 보존, 데이터 복제나 동기화가 필요 없고 자동 확장됨 
- [ ] **B**: EC2 배치 프로세스 + 별도 S3 버킷
    - **이유**: 인스턴스 직접 관리 필요, 배치 방식은 최근 대화가 즉시 반영되지 않음
- [ ] **C**: Ec2 기반 웹 애플리케이션 구축
    - **이유**: 운영 부담이 크고 확장성을 위해선 ASG 필요 
- [ ] **D**: DynamoDB 저장 + Lambda 처리
    - **이유**: S3 텍스트 파일을 읽어 다시 DB에 넣는 과정 추가되어 운영 오버헤드가 큼. 최근 대화가 포함되어야 하므로 동기화 로직이 필요해 복잡도 상승 

---

### 💡 핵심 요약
| Processing | 정의 | 특징 | 사용 | AWS 서비스 | 
| :--- | :--- | :--- | :--- | :--- | 
| **배치 프로세스** | 일정 시간 동안 데이터를 모아 한 번에 처리하는 방식 | 처리 지연 허용<br> 대량 데이터 처리에 유리 <br> 비용 효율적 <br> 실시간성 낮음 | 하루 1회, 매시간, 주기적 <br>로그분석<br>정산, 리포트 생성<br>대용량 데이터 처리 | Amazon EMR, AWS Batch, Glue, Athena | 
| **이벤트 기반 처리** | 특정 이벤트 발생 시 자동으로 처리되는 방식<br>트리거: 상태변화 / 비동기 | 실시간<br>서비스 간 결합도 낮음<br>확장성, 가용성 높음<br>대기시간 없음 | 업로드 완료, 메시지 도착 시, 상태 변경 시 등 | S3 이벤트 알림, EventBridge, SNS/SQS, Lambda |
| **요청 기반 처리** | 사용자 또는 서비스 요청이 들어올 때 즉시 처리하는 방식<br>트리거: 요청 / 동기 | 즉각적인 응답 필요<br>지연에 민감<br>호출자가 결과 기다림<br>성능 병목 발생 가능 | API 호출, 사용자 액션, 조회/검색 | API Gateway, ALB, EC2/ECS, Lambda |