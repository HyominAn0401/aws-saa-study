### 📝 676. 메시지 처리 시스템 고가용성 및 마이그레이션
메시지 처리 시스템을 AWS로 마이그레이션 한 상황. EC2에서 실행되는 ActiveMQ, 소비자 애플리케이션, MySQL DB를 운영중. 운영상의 복잡성을 최소화하고 가용성이 높기를 원할 때, 가장 높은 가용성을 제공하는 아키텍처 설계 
---

### 🎯 1. 요구사항 분석 (Requirements)
* **고가용성**: 서비스의 모든 계층(브로커, 앱, DB)에서 자동 복구가 가능해야 함
* **운영 복잡성 최소화**: 직접 서버를 설치/관리(EC2 기반)하기보다 AWS가 관리해주는 서비스(Managed Service) 선호
* **자동화된 장애 조치**: 장애 발생 시 관리자의 수동 개입 없이 시스템이 스스로 정상 상태 회복해야 함 

---

### 🔍 2. 핵심 서비스 분석 (AWS Documentation 기반)

| 서비스/용어명 | 핵심 특징 | 비고 |
| :--- | :--- | :--- |
| **AmazonMQ** | 설정 및 관리가 필요 없는 완전 관리형 메시지 브로커 서비스 | 장애 시 대기 브로커로 자동 전환 | 
| **Auto Scaling Group** | 설정된 인스턴스 수를 유지하며 장애 시 새 인스턴스를 자동 생성 | |
| **ActiveMQ** | 사용자가 직접 설치하고 관리해야 하는 오픈소스 메시지 브로커 | 운영 오버헤드 높음 |
| **Amazon RDS(Multi-AZ)** | 두 개의 가용영역에 DB를 배치하고 동기 복제 수행 | DB 장애 시 자동 Failover |

---

### ✅ 3. 선택지 분석 및 풀이 (Analysis)

- [ ] **A**: 다른 AZ에 두 번째 ActiveMQ 서버 추가 + 추가 소비자 EC2 추가 + MySQL 직접 복제 
    - **이유**: 모든 구성을 EC2 위에서 직접 관리해야 하므로 운영 복잡성이 매우 높음, 자동 장애 복구 보장 X 
- [ ] **B**: AmazonMQ(활성/대기) + 추가 소비자 EC2 추가 + MySQL 직접 복제 
    - **이유**: 브로커는 관리형, 그러나 앱 서버 자동 복구 기능이 없고 DB 직접 복제 
- [ ] **C**:  AmazonMQ(활성/대기) + 추가 소비자 EC2 추가 + RDS Multi-AZ
    - **이유**: 브로커와 DB 고가용성 확보, 그러나 앱 서버 자동 복구 불가능 
- [X] **D**: AmazonMQ(활성/대기) + ASG 추가 + RDS Multi-AZ 
    - **결과**: **정답**
    - **이유**: 브로커-앱서버-DB 전 구간에 걸쳐 AWS 관리형 서비스를 사용해 운영 부담을 줄이고 ASG로 앱 계층까지 자동 복구 가능 

---

### 💡 핵심 요약
1. 높은 가용성: 모든 계층에 자동 장애 조치(FailOver) 필요
2. EC2 가용성: 단순 늘리는 것이 아니라 ASG로 관리해야 장애가 발생해도 새 인스턴스 생성 가능
3. 운영 최적화 = EC2에 직접 설치하기보다 AmazonMQ, RDS 같은 관리형 서비스 우선 선택 
4. **ASG**정확하게 이해하기: 수평적 확장(Scale out/in), 헬스체크로 인스턴스 상태 감지 및 새 서버 교체 